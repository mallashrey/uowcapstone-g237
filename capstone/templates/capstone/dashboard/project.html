{% load custom_filter %}

<div class="container-card dash-card mt20 mb50">
    <div style="padding: 20px;">
        <div class="app-card__header_title" style="margin-bottom: 2.25rem;">
            Projects
        </div>
        <div class="app-card__body">
            <table class="table">
                <thead>
                    <tr>
                        <th class="table-th-header" scope="col" style="width:35%;">Task</th>
                        <th class="table-th-header" scope="col">Priority</th>
                        <th class="table-th-header" scope="col">Due Date</th>
                        <th class="table-th-header" scope="col">Assigned To</th>
                        <th class="table-th-header" scope="col">Status</th>
                        <th class="table-th-header" scope="col">Progress</th>
                    </tr>
                </thead>
                <tbody>
                    {% for ticket in tickets %}
                    <tr>
                        <td style="font-size: 0.875rem; font-weight: 600;">
                            <a href="{% url 'ticket_detail' ticket.id ticket.ticket_title_slug %}" style="display: -webkit-box;
                            overflow: hidden;
                            -webkit-line-clamp: 2;
                            -webkit-box-orient: vertical;
                            white-space: pre-wrap;" data-toggle="tooltip" data-title="{{ticket.ticket_title}}">{{ ticket.ticket_title }}</a>
                        </td>
                        <td style="font-size: 0.875rem; text-transform: capitalize; font-weight: 600;">
                            <i class="cc-priority {{ticket.priority|getPriority}}"></i>
                            <span>{{ ticket.priority|removeHypens }}</span>
                        </td>
                        <td style="font-size: 0.875rem; text-transform: capitalize; font-weight: 600;">
                            {% if ticket.due_date %}
                                {{ ticket.due_date|date:"Y-m-d" }}
                            {% else %}
                                -
                            {% endif %}
                        </td>
                        <td>
                            <div class="css-xgstl5">
                                {% if ticket.assigned_to.all %}
                                    {% for user in ticket.assigned_to.all %}
                                    <div class="css-1wdn32l" data-toggle="tooltip" data-title="{{user.username}}">
                                        {% if user.img_profile %}
                                        <img  class="rounded-circle css-u226zh" src="/static/{{user.img_profile}}" alt="">
                                        {% else %}
                                        <img  class="rounded-circle css-u226zh" src="/static/images/user-icon.png" alt="">
                                        {% endif %}
                                    </div>
                                    {% endfor %}

                                {% else %}
                                <div style="font-size: 0.875rem; text-transform: capitalize; font-weight: 600; color: #fff;">-</div>
                                {% endif %}
                            </div>
                        </td>
                        <td style="font-size: 0.875rem; text-transform: capitalize; font-weight: 600;">
                            <span class="badge rounded-pill {{ ticket.status|getCSSStatus }}">{{ ticket.status|getStatus }}</span>
                        </td>
                        <td>
                            <!-- <span class="MuiLinearProgress-root MuiLinearProgress-colorPrimary MuiLinearProgress-determinate css-17451yp progress-bar1" role="progressbar" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100">
                                <span class="MuiLinearProgress-bar MuiLinearProgress-barColorPrimary MuiLinearProgress-bar1Determinate css-i6wji9" style="transform: translateX(0%);">
                                </span>
                            </span> -->
                            <div style="display: flex; flex-direction: column; gap: 5px;">
                                <div class="txt-progress">{{ ticket.status|showProgress }}%</div>
                                <div class="css-17451yp MuiLinearProgress-bar skill-bar ">
                                    <div class="css-i6wji9" aria-valuenow="{{ ticket.status|showProgress }}" aria-valuemin="0" aria-valuemax="100">
                                        
                                    </div>
                                </div>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="app-card_footer">
            <a href="{% url 'ticket_list' 'all' %}" class="more-detail">
                <span>See all projects</span>
                <i class="fa-solid fa-arrow-right"></i></a>
        </div>
    </div>
</div>

<script>
        // Progress bars
    $(document).ready(function() {
        $('.css-i6wji9').css("width",
            function() {
                return $(this).attr("aria-valuenow") + "%";
            }
        )
    });
</script>
